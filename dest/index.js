require("source-map-support").install(),function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=9)}([function(e,t){e.exports=require("path")},function(e,t,r){const n=r(5),o={headers:{"Accept-Encoding":""},timeout:1e4,decompress:!1,validateStatus:()=>!0},s=n.create({...o});e.exports={axios:n,axiosFetch:s}},function(e,t){e.exports=require("worker_threads")},function(e,t,r){const n=r(0),o=r(4),{axiosFetch:s}=r(1),a=n.resolve(__dirname),c=async()=>{try{const e=o.readFileSync(n.resolve(a,"package.json"),"utf8"),t=JSON.parse(e),{version:r}=t;return r}catch(e){return console.error(e),"0.0.0"}},i=async e=>{const{data:t}=await s({url:"https://raw.githubusercontent.com/daoquangphuong/free4talk-streaming/master/dest/"+e,method:"GET",responseType:"text",transformResponse:[e=>e]});return t},u=async()=>{try{const e=await i("package.json"),t=JSON.parse(e),{version:r}=t;return r}catch(e){return console.error(e),"0.0.0"}};e.exports={getCurrentVersion:c,getNextVersion:u,check:async()=>{const e=(await c()).split("."),t=(await u()).split(".");for(;e.length<t.length;)e.push("0");for(;t.length<e.length;)t.push("0");if(!t.some((t,r)=>t>e[r]))return;console.info("Has New Version "+t.join(".")),console.info("Updating..."),console.info("Please wait...");const r=await(async()=>{const{data:e}=await s({url:"https://github.com/daoquangphuong/free4talk-streaming/tree/master/dest",method:"GET",responseType:"text",transformResponse:[e=>e]});return e.match(/"\/daoquangphuong\/free4talk-streaming\/blob\/master\/dest\/(.+?)"/g).map(e=>e.match(/"\/daoquangphuong\/free4talk-streaming\/blob\/master\/dest\/(.+?)"/)[1])})();let l=Promise.resolve();r.forEach((e,t)=>{l=l.then(async()=>{console.info(`${t+1}/${r.length} Updating ${e}`),await(async e=>{const t=await i(e);o.writeFileSync(n.resolve(a,e),t,"utf8")})(e)})}),await l}}},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("axios")},,,,function(e,t,r){process.on("unhandledRejection",(e,t)=>{console.error("Unhandled Rejection at:",t,"reason:",e),process.exit(1)});const{Worker:n}=r(2),o=r(0),s=r(3),a=async()=>{await s.check();const e=new n(o.resolve(__dirname,"server.js"));e.on("message",t=>{t&&"update"===t.event&&(e.terminate(),a().catch(console.error))}),e.on("error",console.error),e.on("exit",e=>{0!==e&&console.error("Worker stopped with exit code "+e)})};a().catch(console.error)}]);
//# sourceMappingURL=index.js.map